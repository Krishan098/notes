<!DOCTYPE html>
<html lang="en">
  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <!-- Metadata, OpenGraph and Schema.org -->




<!-- Standard metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>
  
  
    
      WHISPER | Neural Notes
    
  
</title>
<meta name="author" content="Neural Notes">
<meta name="description" content="Notes on WHISPER">

  <meta name="keywords" content="machine-learning, deep-learning, langchain, langgraph, notes">






  <!-- OpenGraph -->
  <meta property="og:site_name" content="Neural Notes">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Neural Notes | WHISPER">
  <meta property="og:url" content="https://krishan098.github.io/notes/blog/2024/whisper/">
  <meta property="og:description" content="Notes on WHISPER">
  
  <meta property="og:locale" content="en">

  <!-- Twitter card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="WHISPER">
  <meta name="twitter:description" content="Notes on WHISPER">
  
  



  <!-- Schema.org -->
  
  
  

  <script type="application/ld+json">
    {
        "author":
        {
            "@type": "Person",
            "name": "Neural Notes"
        },
        "url": "https://krishan098.github.io/notes/blog/2024/whisper/",
        "@type": "BlogPosting",
        "description": "Notes on WHISPER",
        "headline": "WHISPER",
        
        "sameAs": ["https://github.com/Krishan098"],
        
        "name": "Neural Notes",
        "@context": "https://schema.org"
    }
  </script>



<!-- Bootstrap & MDB -->
<link rel="stylesheet" href="/notes/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">



<!-- Fonts & Icons -->
<link defer rel="stylesheet" href="/notes/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5">
<link defer rel="stylesheet" href="/notes/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772">
<link defer rel="stylesheet" type="text/css" href="">

<!-- Code Syntax Highlighting -->
<link defer rel="stylesheet" href="/notes/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light">


  <!-- Sidebar Table of Contents -->
  <link defer href="/notes/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet">


<!-- Styles -->




  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%93%9D&lt;/text&gt;&lt;/svg&gt;">

<link rel="stylesheet" href="/notes/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e">
<link rel="canonical" href="https://krishan098.github.io/notes/blog/2024/whisper/">


  <!-- Dark Mode -->
  <script src="/notes/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script>
  <link defer rel="stylesheet" href="/notes/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark">
  <script>
    initTheme();
  </script>










  </head>

  <!-- Body -->
  <body class="fixed-top-nav sticky-bottom-footer">
    <!-- Header -->
    <header>
  <!-- Nav Bar -->
  <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation">
    <div class="container">
      
        <a class="navbar-brand title font-weight-lighter" href="/notes/">
          Neural Notes
        </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>

      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          

          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/notes/">About
              
            </a>
          </li>

          <!-- Other pages -->
          
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
              
                
                <li class="nav-item active">
                  <a class="nav-link" href="/notes/blog/">blog
                    
                  </a>
                </li>
              
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
          
            <!-- Search -->
            <li class="nav-item">
              <button id="search-toggle" title="Search" onclick="openSearchModal()">
                <span class="nav-link">ctrl k <i class="ti ti-search"></i></span>
              </button>
            </li>
          
          
            <!-- Toogle theme mode -->
            <li class="toggle-container">
              <button id="light-toggle" title="Change theme">
                <i class="ti ti-sun-moon" id="light-toggle-system"></i>
                <i class="ti ti-moon-filled" id="light-toggle-dark"></i>
                <i class="ti ti-sun-filled" id="light-toggle-light"></i>
              </button>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>
  
    <!-- Scrolling Progress Bar -->
    <progress id="progress" value="0">
      <div class="progress-container">
        <span class="progress-bar"></span>
      </div>
    </progress>
  
</header>


    <!-- Content -->
    <div class="container mt-5" role="main">
      
        
          <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-3">
              <nav id="toc-sidebar" class="sticky-top"></nav>
            </div>
            <!-- main content area -->
            <div class="col-sm-9">






<div class="post">
  <header class="post-header">
    <h1 class="post-title">WHISPER</h1>
    <p class="post-meta">
      Created on January 07, 2024
      
      
      
    </p>
    <p class="post-tags">
      
        <a href="/notes/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>
      
      
          ·  
        
          
            <a href="/notes/blog/tag/machine-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> machine-learning</a>
          
          
        
      

      
          ·  
        
          
            <a href="/notes/blog/category/machine-learning"> <i class="fa-solid fa-tag fa-sm"></i> Machine Learning</a>
          
          
        
      
    </p>
  </header>

  <article class="post-content">
    
    <div id="markdown-content">
      <h1 id="robust-speech-recognition-via-large-scale-weak-supervision">Robust Speech Recognition via Large-Scale Weak Supervision</h1>
<hr>
<h2 id="abstract">Abstract</h2>

<ul>
  <li>This paper studies the capabilities of speech processing systems trained simply to predict large amounts of transcripts of audio on the internet.</li>
</ul>

<hr>
<h2 id="introduction">Introduction</h2>

<ul>
  <li>
    <p>The pre-trained autoencoders learn high-quality representations of speech, but because they are purely unsupervised they lack an equivalently performant decoder mapping those representations to usable outputs, necessitating a fine-tuning stage in order to actually perform a task such as speech recognition.</p>
  </li>
  <li>
    <p>Machine learning methods are exceedingly adept at finding patterns within a training dataset which boost performance on held-out data from the dataset.However some of these patterns are brittle and spurious and don’t generalize to other datasets and distributions.</p>
  </li>
  <li>
    <p>This suggests that while unsupervised pre-training has improved the quality of audio encoders dramatically, the lack of an equivalently high-quality pre-trained decoder, combined with a recommended protocol of dataset-specific fine-tuning is a crucial weakness which limits their usefulness and robustness.</p>
  </li>
  <li>
    <p>Speech recognition systems that are pre-trained in a supervised fashion across many datasets exhibit higher robustness and generalize much more effectively to held-out datasets than models trained on a single-source. These works achieve this by combining as many existing high-quality speech recognition datasets as possible.</p>
  </li>
  <li>
    <p>Recognizing the limit size of existing high-quality supervised datasets, recent efforts have created larger datasets for speech recognition.Recent work in computer vision has demonstrated that moving beyond gold-standard crowdsourced datasets such as ImageNet to much larger but weakly supervised datasets significantly improves the robustness and generalization of models.</p>
  </li>
  <li>
    <p>Scaling weakly supervised speech recognition the next order of magnitude to 680,000 hours of labeled audio data.</p>
  </li>
  <li>
    <h2 id="this-work-suggests-that-simple-scaling-of-weakly-supervised-pre-training-has-been-underappreciated-so-far">This work suggests that simple scaling of weakly supervised pre-training has been underappreciated so far.</h2>
    <h2 id="approach">Approach</h2>
  </li>
</ul>

<h3 id="data-processing">Data Processing</h3>

<ul>
  <li>
    <p>Whisper has been trained to predict the raw text of transcripts without any significant standardization,relying on the expressiveness of the sequence-to-sequence models to learn to map between utterances and their transcribed form.</p>
  </li>
  <li>
    <p>For the dataset the audio is paired with their respective transcripts available on the internet. This results in a very diverse dataset covering a broad distribution of audio from many different environments, recording setups,speakers and languages.</p>
  </li>
  <li>
    <p>diversity in audio quality is beneficial but in transcript quality might not be beneficial.</p>
  </li>
  <li>
    <p>Many existing ASR systems output only a limited subset of written language which removes or normalizes away aspects that are difficult to predict from only audio signals such as complex punctuation(exclamation points, commas, and question marks), formatting whitespace such as paragraphs, or stylistic aspects such as capitalization.</p>
  </li>
  <li>
    <p>An all uppercase or all-lowercase transcript is very unlikely to be human generated. Many ASRs involve inverse text normalization, it is often simple or rule based and still detectable from other unhandled aspects such as never including commas.</p>
  </li>
  <li>
    <p>The researchers have also used an audio language detector which was created by fine-tuning a prototype model trained on a prototype version of the dataset on VoxLingua107 to ensure that the spoken language matches the language of the transcript according to CLD2.</p>
  </li>
  <li>
    <p>Exception: if the transcript is in english and are addded as X-&gt;en speech translation training examples instead.</p>
  </li>
  <li>
    <p>Also used fuzzy de-duping and automatically generated content in the training dataset.</p>
  </li>
  <li>
    <p>They broke audio files down into 30 segments paired with the subset of the transcript that occurs within that time segment. They trained it on all audio including segments where there is no speech.</p>
  </li>
  <li>
    <h2 id="for-an-additional-filtering-pass-after-training-an-initial-model-they-aggregated-information-about-its-error-rate-on-training-data-sources-and-performed-manual-inspection-of-these-data-sources-sorting-by-a-combination-of-both-high-error-rate-and-data-source-size-in-order-to-identify-and-remove-low-quality-ones-efficiently-this-inspection-showed-a-large-number-of-poorly-aligned-transcripts-as-well-as-remaining-low-quality-machine--generated-captions-that-filtering-heuristics-did-not-detect">For an additional filtering pass, after training an initial model they aggregated information about its error rate on training data sources and performed manual inspection of these data sources sorting by a combination of both high error rate and data source size in order to identify and remove low-quality ones efficiently. This inspection showed a large number of poorly aligned transcripts as well as remaining low-quality machine -generated captions that filtering heuristics did not detect.</h2>
    <h3 id="model">Model</h3>
  </li>
  <li>
    <p>Used an encoder-decoder structure.</p>
  </li>
  <li>
    <p>resampled all audio files to 16,000 Hz.</p>
  </li>
  <li>
    <p>For feature normalization, we globally scale the input to be between -1 and 1 with approximately zero mean across the pre-training dataset.</p>
  </li>
  <li>
    <p>The encoder processes this input representation with a small stem consisting of two convolution layers with a filter width of 3 and the GELU activation function where the second convolution layer has a stride of two.</p>
  </li>
  <li>
    <p>Sinusoidal position embeddings are then added to the output of the stem after which the encoder Transformer blocks are applied. The transformer uses pre-activation residual blocks and a final layer normalization is applied to the encoder output. The decoder uses learned position embeddings and tied input-output token representations.</p>
  </li>
  <li>
    <h2 id="the-encoder-and-decoder-have-the-same-width-and-number-of-transformer-blocks">The encoder and decoder have the same width and number of transformer blocks.</h2>
    <h3 id="multitask-format">Multitask Format</h3>
  </li>
  <li>
    <p>A fully featured speech recognition system can involve many additional components such as voice activity detection, speaker diarization and inverse text normalization.</p>
  </li>
  <li>
    <p>Many tasks can be performed on the same input signal: transcription, translation, voice activity detection, alignment, and language identification etc.</p>
  </li>
  <li>
    <p>A simple format to specify all tasks and conditioning information as a sequence of input tokens to the decoder. Since the decoder is an audio-conditional language model, we also train it to condition on the history of text of the transcript in the hope that it will learn to use longer-range text context to resolve ambiguous audio.</p>
  </li>
  <li>
    <p>With some probability they add the transcript text preceeding the current audio segment to the decoder’s context.</p>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Indicate the beginning of prediction with a &lt;</td>
          <td>startoftranscript</td>
          <td>&gt; token.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>First, predict the language being spoken which is represented by a unique token for each language in the training set.</p>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>For the audio segments where there is no speech, the model is trained to predict &lt;</td>
          <td>nospeech</td>
          <td>&gt; token indicating this. The next token specifies the task (either transcriptopn &lt;</td>
          <td>trancribe</td>
          <td>&gt; or translation&lt;</td>
          <td>translate</td>
          <td>&gt;).</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Another token &lt;</td>
          <td>notimestamps</td>
          <td>&gt; is used to decide whether to predict timestamps or not.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Lastly , a &lt;</td>
          <td>endoftranscript</td>
          <td>&gt; token is added.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Only mask out the training loss over the previous context textt and train the model  to predict all other tokens.</li>
</ul>

<h2><img src="/notes/assets/img/posts/image-15.png" alt=""></h2>
<h3 id="training-details">Training Details</h3>

<ul>
  <li>
    <p>Training has been done with data parallelism across accelerators using FP16 with dynamic loss scaling and activation checkpointing.</p>
  </li>
  <li>
    <p>trained with AdamW and gradient norm clipping with a linear learning rate decay to zero after a warmup over the first 2048 updates.</p>
  </li>
  <li>
    <p>A batch size of 256 segments was used, and the models are trained for $2^20$ updates which is between two and three passes over the dataset.</p>
  </li>
</ul>

    </div>
  </article>

  

  

  
    
  

  
  
</div>
</div>
          </div>
        
      
    </div>

    <!-- Footer -->
    


  <footer class="sticky-bottom mt-5" role="contentinfo">
    

    <div class="container">
      
  © Copyright 2025
  Neural
  
  Notes. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme.

  
  
    Last updated: November 27, 2025.
  

    </div>
  </footer>



    <!-- JavaScripts -->
    <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<!-- Bootsrap & MDB scripts -->
<script src="/notes/assets/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>


  <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="" integrity="" crossorigin="anonymous"></script>
  <script defer src="/notes/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script>























  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
  <script defer src="/notes/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script>



  <!-- Sidebar Table of Contents -->
  <script defer src="/notes/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script>




<!-- Load Common JS -->
<script src="/notes/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script>
<script defer src="/notes/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script>
<script defer src="/notes/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script>

<!-- Jupyter Open External Links New Tab -->
<script defer src="/notes/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script>

<!-- Badges -->




  <!-- MathJax -->
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script>
  
    <script src="/notes/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script>
    <script defer src="" crossorigin="anonymous"></script>
  









  <!-- Scrolling Progress Bar -->
  <script defer src="/notes/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script>







  <!-- Back to Top -->
  <script src="/notes/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script>
  <script>
    addBackToTop();
  </script>



  <!-- Search -->
  <script type="module" src="/notes/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script>
  <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys>
  <script src="/notes/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script>
  <script src="/notes/assets/js/search-data.js"></script>
  <script src="/notes/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script>




  </body>
</html>
